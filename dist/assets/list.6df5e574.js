var Y=Object.defineProperty,H=Object.defineProperties;var G=Object.getOwnPropertyDescriptors;var B=Object.getOwnPropertySymbols;var J=Object.prototype.hasOwnProperty,K=Object.prototype.propertyIsEnumerable;var I=(e,t,r)=>t in e?Y(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,P=(e,t)=>{for(var r in t||(t={}))J.call(t,r)&&I(e,r,t[r]);if(B)for(var r of B(t))K.call(t,r)&&I(e,r,t[r]);return e},E=(e,t)=>H(e,G(t));import{g as Z}from"./voices.9aa06563.js";import{s as F,_ as M}from"./index.ac7bf4b1.js";import{u as X}from"./UseSearch.32a49bf2.js";import{u as $,a as ee,b as oe}from"./UseDialog.7d7ff299.js";import{r as D,f as le,x as te,Z as s,o as y,K as q,L as a,M as j,O as A,T as o,R as g,S as p,a as m,c as w,F as Q,a2 as z,G as O,Q as U}from"./@vue.9f1b68af.js";import{b as T,c as ae}from"./element-plus.55dd86f2.js";import{Q as ne}from"./@element-plus.a205db37.js";import"./vue-router.949634a5.js";import"./vuex.49683c05.js";import"./moment.a5c37c1e.js";import"./axios.8b958ab2.js";import"./js-cookie.31874410.js";import"./nprogress.2f56b1fe.js";import"./lodash-es.3d1d9723.js";import"./@vueuse.ef512f30.js";import"./@popperjs.da6c49cb.js";import"./@ctrl.2e36ce53.js";import"./dayjs.644349ef.js";import"./async-validator.5d25c98b.js";import"./memoize-one.4ee5c96d.js";import"./escape-html.e5dfadb9.js";import"./normalize-wheel-es.1c4ac15a.js";const se=[{label:"\u5E8F\u53F7",type:"index",width:"100px"},{label:"\u5BA2\u6237\u59D3\u540D",prop:"clientName"},{label:"\u53F7\u7801",prop:"tel"},{label:"\u901A\u8BDD\u72B6\u6001",prop:"callStatus",render:e=>({0:"\u672A\u77E5",1:"\u5DF2\u63A5\u542C",2:"\u672A\u63A5\u542C",3:"\u547C\u635F"})[e.callStatus]},{label:"\u901A\u8BDD\u65F6\u957F",prop:"tel"},{label:"\u64CD\u4F5C",prop:"operation",slot:"operation"}];function R(e){return F({url:"call/tel/task/record",method:"get",params:e})}function re(e){return F({url:`call/tel/task/record/${e}`,method:"get"})}function ie(e){return F({url:"call/tel/task/record/word",method:"get",params:{uuid:e}})}const de={props:{value:{type:Boolean,default:!1},type:{type:String,default:""},defaultForm:{type:Object,default:()=>({})}},emits:["cancel","confirm"],setup(e,{emit:t}){const r=D(null),l=D(null),N=D(""),L=D([]),i={defaultForm:P({},e.defaultForm),defaultRules:{},confirm:()=>{v.value=!1,t("cancel")},cancel:()=>{v.value=!1,t("cancel")}};le(()=>e.defaultForm,d=>{e.value&&(l.value=d.id,e.type==="dialogue"?C(d.uuid):k(d.id))},{immediate:!0,deep:!0});const h=$(r,i),{getTitle:f,visible:v}=ee(e,{look:"\u67E5\u770B\u8BE6\u60C5",dialogue:"\u804A\u5929\u5185\u5BB9"}),k=d=>{re(d).then(b=>{h.setForm(P({},b.data))})},C=d=>{ie(d).then(b=>{L.value=b.data})},u=te(()=>({0:"\u672A\u77E5",1:"\u5DF2\u63A5\u542C",2:"\u672A\u63A5\u542C",3:"\u547C\u635F"})[h.form.value.callStatus]||"-");let _=!1;const n=d=>{N.value=d||"http://96.ierge.cn/15/238/476505.mp3?v=0524";const b=document.getElementById("lgAudio");b.addEventListener("loadeddata",function(){b.play()},!1),b.addEventListener("ended",function(){N.value=""},!1),b.addEventListener("error",function(S){N.value="",!_&&(_=!0,T.error("\u64AD\u653E\u5931\u8D25"),setTimeout(()=>{_=!1},500))},!1)},V=d=>({0:"\u672A\u77E5",1:"\u5BA2\u6237",2:"\u673A\u5668\u4EBA",3:"\u5BA2\u670D"})[d];return E(P({visible:v,title:f,formRef:r},h),{dialogueList:L,audioUrl:N,getStatusText:u,handlePlay:n,getName:V})}},ce=g(p("-")),ue=["src"],me={class:"dialogue-box"},fe={key:0,class:"dialogue-box--ul"},_e={key:0,class:"li-left"},pe={class:"flex-box dialogue-info"},ge={class:"flex-box flex-column"},he={class:"name"},be={class:"content-wrap flex-box"},ye={class:"dialogue-content"},ve={key:0,class:"dialogue-tools flex-box flex-end"},ke=["onClick"],xe={key:1,class:"li-right flex-box flex-column"},Ce={class:"flex-box flex-end"},Ve={class:"flex-box flex-column",style:{"align-items":"flex-end"}},we={class:"name"},De={class:"content-wrap flex-box"},Ne={key:0,class:"dialogue-tools flex-box flex-end"},Le=["onClick"],Pe={class:"dialogue-content"},Ue={key:1,class:"empty"},qe=["src"];function Ee(e,t,r,l,N,L){const i=s("el-descriptions-item"),h=s("el-rate"),f=s("el-descriptions"),v=s("el-form"),k=s("svg-icon"),C=s("el-tooltip"),u=s("el-divider"),_=s("el-dialog");return y(),q(_,{"custom-class":"voices-dialog",modelValue:l.visible,"onUpdate:modelValue":t[1]||(t[1]=n=>l.visible=n),title:l.title,"before-close":e.handleCancel,width:"700px","destroy-on-close":""},{default:a(()=>[j(o(v,{ref:"formRef",style:{"margin-top":"10px",width:"100%"}},{default:a(()=>[o(f,{title:"",column:1},{default:a(()=>[o(i,{label:"\u4EFB\u52A1\u540D\u79F0:"},{default:a(()=>[g(p(e.form.taskName||"-"),1)]),_:1}),o(i,{label:"\u8BDD\u672F\u540D\u79F0:"},{default:a(()=>[g(p(e.form.flowName||"-"),1)]),_:1}),o(i,{label:"\u5BA2\u6237\u6807\u7B7E\u540D\u79F0:"},{default:a(()=>[g(p(e.form.tagName||"-"),1)]),_:1}),o(i,{label:"\u5BA2\u6237\u540D\u79F0:"},{default:a(()=>[g(p(e.form.clientName||"-"),1)]),_:1}),o(i,{label:"\u53F7\u7801:"},{default:a(()=>[g(p(e.form.tel||"-"),1)]),_:1}),o(i,{label:"\u901A\u8BDD\u72B6\u6001:"},{default:a(()=>[g(p(l.getStatusText||"-"),1)]),_:1}),o(i,{label:"\u901A\u8BDD\u65F6\u957F:"},{default:a(()=>[g(p(e.form.talkDuration||"-"),1)]),_:1}),o(i,{label:"\u5750\u5E2D\u540D\u79F0:"},{default:a(()=>[ce]),_:1}),o(i,{label:"\u8BC4\u4EF7:"},{default:a(()=>[o(h,{modelValue:e.form.grade,"onUpdate:modelValue":t[0]||(t[0]=n=>e.form.grade=n)},null,8,["modelValue"])]),_:1}),o(i,{label:"\u5907\u6CE8:"},{default:a(()=>[g(p(e.form.black||"-"),1)]),_:1}),o(i,{label:"\u901A\u8BDD\u5F55\u97F3:"},{default:a(()=>[m("audio",{src:e.form.talkUrl,controls:"",style:{height:"34px"}},null,8,ue)]),_:1})]),_:1})]),_:1},512),[[A,r.type==="look"]]),j(m("div",me,[l.dialogueList&&l.dialogueList.length?(y(),w("ul",fe,[(y(!0),w(Q,null,z(l.dialogueList,(n,V)=>(y(),w("li",{class:"dialogue-box--li",key:V},[n.role==1?(y(),w("div",_e,[m("div",pe,[o(k,{name:"customer",class:"dialogue-icon left"}),m("div",ge,[m("span",he,p(l.getName(n.role)),1),m("div",be,[m("span",ye,p(n.word),1),n.recUrl?(y(),w("div",ve,[o(C,{class:"item",effect:"dark",content:"\u64AD\u653E",placement:"bottom"},{default:a(()=>[m("span",{class:O(["tools-item",l.audioUrl===n.recUrl&&"playAnimate"]),onClick:d=>l.handlePlay(n.recUrl)},[o(k,{name:"audio"})],10,ke)]),_:2},1024)])):U("",!0)])])])])):n.role==2||n.role==3?(y(),w("div",xe,[m("div",Ce,[m("div",Ve,[m("span",we,p(l.getName(n.role)),1),m("div",De,[n.recUrl?(y(),w("div",Ne,[o(C,{class:"item",effect:"dark",content:"\u64AD\u653E",placement:"bottom"},{default:a(()=>[m("span",{class:O(["tools-item",l.audioUrl===n.recUrl&&"playAnimate"]),onClick:d=>l.handlePlay(n.recUrl)},[o(k,{name:"audio"})],10,Le)]),_:2},1024)])):U("",!0),m("span",Pe,p(n.word),1)])]),o(k,{name:n.role==3?"customer-service":"customer-service1",class:"dialogue-icon right"},null,8,["name"])])])):U("",!0),n.role==4?(y(),q(u,{key:2,"content-position":"center"},{default:a(()=>[g(p(n.word),1)]),_:2},1024)):U("",!0)]))),128))])):(y(),w("div",Ue,"\u6682\u65E0\u6570\u636E")),m("audio",{style:{height:"0px"},src:l.audioUrl,id:"lgAudio",controls:"true"},null,8,qe)],512),[[A,r.type!=="look"]])]),_:1},8,["modelValue","title","before-close"])}var Te=M(de,[["render",Ee]]);const Fe={components:{DetailDialog:Te,Download:ne},setup(){const e=D(null),t=D({taskId:""}),{toQuery:r,clearForm:l}=X(t,e),N=oe(r),L=D([]),i=D(!1),h=u=>{i.value=!0,Z({pageSize:1e3,pageNumber:1,name:u}).then(n=>{L.value=n.rows,i.value=!1}).catch(()=>{i.value=!1})},f=D(!1),v=(u=[])=>{let _={},n=[];if(u.length)for(let d in u){let b={\u5E8F\u53F7:Number(d)+1,\u59D3\u540D:u[d].name,\u7535\u8BDD:u[d].tel};n.push(b)}_.fileName="\u77ED\u4FE1\u53D1\u9001\u8BB0\u5F55",_.datas=[{sheetData:n,sheetName:"sheet",sheetHeader:["\u5E8F\u53F7","\u59D3\u540D","\u7535\u8BDD"],sheetFilter:["\u5E8F\u53F7","\u59D3\u540D","\u7535\u8BDD"]}],new ExportJsonExcel(_).saveExcel()},k=()=>{f.value=!0;const u={pageSize:1e3,pageNumber:1,taskId:t.taskId};R(u).then(_=>{v(_.rows),f.value=!1}).catch(()=>{f.value=!1,T.error("\u5BFC\u51FA\u5931\u8D25\uFF01")})},C=u=>{ae.confirm("\u662F\u5426\u786E\u5B9A\u5220\u9664\uFF1F","\u63D0\u793A",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(()=>{}).catch(()=>{T({type:"info",message:"\u53D6\u6D88\u5220\u9664"})})};return E(P({basicTableRef:e,queryParams:t,getList:R,columns:se,getTaskListAll:h,taskList:L,loading:i,toQuery:r,clearForm:l,handleExport:k},N),{exportLoading:f,handleDelete:C})}},Se=g(" \u5BFC\u51FA"),Be=g(" \u8BE6\u60C5 "),Ie=g(" \u5BF9\u8BDD "),je=g(" \u5220\u9664 ");function Ae(e,t,r,l,N,L){const i=s("el-date-picker"),h=s("el-form-item"),f=s("el-col"),v=s("el-select"),k=s("el-option"),C=s("el-input"),u=s("SearchWrap"),_=s("download"),n=s("el-icon"),V=s("el-button"),d=s("BasicTable"),b=s("ListContainer"),S=s("DetailDialog"),W=s("PageWrapper");return y(),q(W,null,{default:a(()=>[o(u,{onReset:l.clearForm,onSearch:l.toQuery,model:l.queryParams},{default:a(({colSpan:x})=>[o(f,{span:x},{default:a(()=>[o(h,{label:"\u65F6\u95F4"},{default:a(()=>[o(i,{placeholder:"\u8BF7\u9009\u62E9",type:"daterange",modelValue:l.queryParams.time,"onUpdate:modelValue":t[0]||(t[0]=c=>l.queryParams.time=c),"value-format":"YYYY-MM-DD","start-placeholder":"\u5F00\u59CB\u65E5\u671F","end-placeholder":"\u7ED3\u675F\u65E5\u671F",onChange:l.toQuery},null,8,["modelValue","onChange"])]),_:1})]),_:2},1032,["span"]),o(f,{span:x},{default:a(()=>[o(h,{label:"\u901A\u8BDD\u72B6\u6001"},{default:a(()=>[o(v,{modelValue:l.queryParams.clientName,"onUpdate:modelValue":t[1]||(t[1]=c=>l.queryParams.clientName=c),placeholder:"\u8BF7\u9009\u62E9\u901A\u8BDD\u72B6\u6001"},null,8,["modelValue"])]),_:1})]),_:2},1032,["span"]),o(f,{span:x},{default:a(()=>[o(h,{label:"\u4EFB\u52A1\u540D\u79F0"},{default:a(()=>[o(v,{modelValue:l.queryParams.taskId,"onUpdate:modelValue":t[2]||(t[2]=c=>l.queryParams.taskId=c),filterable:"",remote:"","remote-method":l.getTaskListAll,loading:l.loading,placeholder:"\u8BF7\u8F93\u5165\u4EFB\u52A1\u540D\u79F0",style:{width:"100%"}},{default:a(()=>[(y(!0),w(Q,null,z(l.taskList,c=>(y(),q(k,{key:c.id,label:c.name,value:c.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","remote-method","loading"])]),_:1})]),_:2},1032,["span"]),o(f,{span:x},{default:a(()=>[o(h,{label:"\u53F7\u7801"},{default:a(()=>[o(C,{modelValue:l.queryParams.phoneNumber,"onUpdate:modelValue":t[3]||(t[3]=c=>l.queryParams.phoneNumber=c),placeholder:"\u8BF7\u8F93\u5165\u53F7\u7801"},null,8,["modelValue"])]),_:1})]),_:2},1032,["span"]),o(f,{span:x},{default:a(()=>[o(h,{label:"\u5750\u5E2D"},{default:a(()=>[o(C,{modelValue:l.queryParams.phoneNumber,"onUpdate:modelValue":t[4]||(t[4]=c=>l.queryParams.phoneNumber=c),placeholder:"\u8BF7\u8F93\u5165\u53F7\u7801"},null,8,["modelValue"])]),_:1})]),_:2},1032,["span"])]),_:1},8,["onReset","onSearch","model"]),o(b,null,{default:a(()=>[o(d,{columns:l.columns,queryApi:l.getList,queryParams:l.queryParams,ref:"basicTableRef"},{tableHeader:a(()=>[o(V,{type:"primary",loading:l.exportLoading,onClick:t[5]||(t[5]=x=>l.handleExport())},{default:a(()=>[o(n,{size:"14px"},{default:a(()=>[o(_)]),_:1}),Se]),_:1},8,["loading"])]),operation:a(({data:x})=>[o(V,{type:"text",onClick:c=>e.handleOperationClick("look",x)},{default:a(()=>[Be]),_:2},1032,["onClick"]),o(V,{type:"text",onClick:c=>e.handleOperationClick("dialogue",x)},{default:a(()=>[Ie]),_:2},1032,["onClick"]),o(V,{type:"text",style:{color:"#f56c6c"},onClick:c=>l.handleDelete(x)},{default:a(()=>[je]),_:2},1032,["onClick"])]),_:1},8,["columns","queryApi","queryParams"])]),_:1}),o(S,{value:e.showDialog,type:e.typeDialog,defaultForm:e.defaultForm,onCancel:e.handleCancel,onConfirm:e.handleConfirm},null,8,["value","type","defaultForm","onCancel","onConfirm"])]),_:1})}var co=M(Fe,[["render",Ae]]);export{co as default};

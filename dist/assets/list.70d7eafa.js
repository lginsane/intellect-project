var L=Object.defineProperty,I=Object.defineProperties;var V=Object.getOwnPropertyDescriptors;var T=Object.getOwnPropertySymbols;var B=Object.prototype.hasOwnProperty,S=Object.prototype.propertyIsEnumerable;var N=(e,t,o)=>t in e?L(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,h=(e,t)=>{for(var o in t||(t={}))B.call(t,o)&&N(e,o,t[o]);if(T)for(var o of T(t))S.call(t,o)&&N(e,o,t[o]);return e},y=(e,t)=>I(e,V(t));import{u as q,a as w,b as E}from"./UseDialog.7d7ff299.js";import{s as C,_ as $}from"./index.e88c8aa4.js";import{b as v,c as O}from"./element-plus.55dd86f2.js";import{r as b,f as P,Z as c,o as D,K as F,L as i,a as p,T as d,R as f,i as R,S as x}from"./@vue.9f1b68af.js";import"./vue-router.949634a5.js";import"./vuex.49683c05.js";import"./moment.a5c37c1e.js";import"./axios.8b958ab2.js";import"./js-cookie.31874410.js";import"./@element-plus.a205db37.js";import"./nprogress.2f56b1fe.js";import"./lodash-es.3d1d9723.js";import"./@vueuse.ef512f30.js";import"./@popperjs.da6c49cb.js";import"./@ctrl.2e36ce53.js";import"./dayjs.644349ef.js";import"./async-validator.5d25c98b.js";import"./memoize-one.4ee5c96d.js";import"./escape-html.e5dfadb9.js";import"./normalize-wheel-es.1c4ac15a.js";function M(e){return C({url:"qt/tag/tree",method:"get",params:e})}function U(e){return C({url:"qt/tag/add",method:"post",data:e})}function W(e){return C({url:"qt/tag/update",method:"post",data:e})}function K(e){return C({url:"qt/tag/delete",method:"delete",params:e})}const Z={props:{value:{type:Boolean,default:!1},type:{type:String,default:""},defaultForm:{type:Object,default:()=>({})}},emits:["cancel","confirm"],setup(e,{emit:t}){const o=b(!1),r=b(null),g={defaultForm:h({tagName:"",parentId:0},e.defaultForm),defaultRules:{tagName:[{required:!0,message:"\u8BF7\u8F93\u5165\u6807\u7B7E\u540D\u79F0",trigger:"blur"}]},confirm:n=>{if(o.value)return;o.value=!0;const m=n.id?"\u7F16\u8F91\u6210\u529F":"\u65B0\u589E\u6210\u529F";(n.id?W:U)(n).then(()=>{v({type:"success",message:m,duration:1e3}),l.value=!1,o.value=!1,t("confirm")}).finally(()=>{o.value=!1})},cancel:()=>{l.value=!1,t("cancel")}};P(()=>e.defaultForm,n=>{a.value==="\u65B0\u589E"&&n.id?s.setForm({parentId:n.id,tagName:""}):s.setForm(y(h({},n),{parentId:n.parentId?n.parentId:0}))});const s=q(r,g),{getTitle:a,visible:l}=w(e,{create:"\u65B0\u589E",edit:"\u7F16\u8F91"});return h({visible:l,title:a,formRef:r,btnLoading:o},s)}},z={class:"dialog-footer"},A=f("\u53D6\u6D88"),G=f("\u786E\u5B9A");function H(e,t,o,r,g,s){const a=c("el-input"),l=c("el-form-item"),n=c("el-form"),m=c("el-button"),_=c("el-dialog");return D(),F(_,{modelValue:r.visible,"onUpdate:modelValue":t[1]||(t[1]=u=>r.visible=u),title:r.title,"before-close":e.handleCancel},{footer:i(()=>[p("span",z,[d(m,{type:"default",onClick:e.handleCancel},{default:i(()=>[A]),_:1},8,["onClick"]),d(m,{type:"primary",loading:r.btnLoading,onClick:e.handleConfirm},{default:i(()=>[G]),_:1},8,["loading","onClick"])])]),default:i(()=>[d(n,{ref:"formRef",model:e.form,rules:e.rules},{default:i(()=>[d(l,{label:"\u6807\u7B7E\u540D\u79F0:",prop:"tagName"},{default:i(()=>[d(a,{modelValue:e.form.tagName,"onUpdate:modelValue":t[0]||(t[0]=u=>e.form.tagName=u),placeholder:"\u8BF7\u8F93\u5165\u6807\u7B7E\u540D\u79F0",maxlength:12},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title","before-close"])}var J=$(Z,[["render",H]]);const Q={components:{CreateDialog:J},setup(){const e=b([]),t=()=>{M().then(s=>{e.value=o(s.root),console.log(e.value)})},o=(s=[],a=0)=>{if(s.length)return s.forEach(l=>{l.parentId=a,l.childrenTagList&&l.childrenTagList.length&&l.childrenTagList.forEach(n=>{n.parentId=l.id,n.childrenTagList&&n.childrenTagList.length&&o(n.childrenTagList,n.id)})}),s},r=E(t),g=(s,a)=>{O.confirm("\u662F\u5426\u786E\u5B9A\u5220\u9664\uFF1F","\u63D0\u793A",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(()=>{K({id:a}).then(()=>{v({type:"success",message:"\u5220\u9664\u6210\u529F"}),t()})}).catch(()=>{v({type:"info",message:"\u53D6\u6D88\u5220\u9664"})})};return R(()=>{t()}),y(h({},r),{dataSource:e,handleDelete:g})}},X={class:"container"},Y=f(" \u65B0\u5EFA\u6807\u7B7E "),j={class:"content"},ee={class:"custom-tree-node flex-box flex-between"},te=f(" \u6DFB\u52A0\u5B50\u7EA7 "),oe=f(" \u7F16\u8F91 "),ne=f(" \u5220\u9664 ");function ae(e,t,o,r,g,s){const a=c("el-button"),l=c("el-tree"),n=c("CreateDialog"),m=c("PageWrapper");return D(),F(m,null,{default:i(()=>[p("div",X,[d(a,{type:"primary",onClick:t[0]||(t[0]=_=>e.handleOperationClick("create"))},{default:i(()=>[Y]),_:1}),p("div",j,[d(l,{data:r.dataSource,"node-key":"id","default-expand-all":"",props:{label:"deptName",children:"childrenTagList"}},{default:i(({node:_,data:u})=>[p("span",ee,[p("span",null,x(u.tagName),1),p("span",null,[d(a,{type:"text",onClick:k=>e.handleOperationClick("create",{id:u.id})},{default:i(()=>[te]),_:2},1032,["onClick"]),d(a,{type:"text",onClick:k=>e.handleOperationClick("edit",u)},{default:i(()=>[oe]),_:2},1032,["onClick"]),d(a,{type:"text",onClick:k=>r.handleDelete(_,u.id),style:{color:"#f56c6c"}},{default:i(()=>[ne]),_:2},1032,["onClick"])])])]),_:1},8,["data"])])]),d(n,{value:e.showDialog,type:e.typeDialog,defaultForm:e.defaultForm,onCancel:e.handleCancel,onConfirm:e.handleConfirm},null,8,["value","type","defaultForm","onCancel","onConfirm"])]),_:1})}var De=$(Q,[["render",ae]]);export{De as default};

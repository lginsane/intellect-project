var W=Object.defineProperty,A=Object.defineProperties;var O=Object.getOwnPropertyDescriptors;var U=Object.getOwnPropertySymbols;var E=Object.prototype.hasOwnProperty,z=Object.prototype.propertyIsEnumerable;var T=(e,o,s)=>o in e?W(e,o,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[o]=s,v=(e,o)=>{for(var s in o||(o={}))E.call(o,s)&&T(e,s,o[s]);if(U)for(var s of U(o))z.call(o,s)&&T(e,s,o[s]);return e},q=(e,o)=>A(e,O(o));import{s as w,_ as B,d as M}from"./index.ac7bf4b1.js";import{u as Z}from"./UseSearch.32a49bf2.js";import{u as j,a as Q,b as G}from"./UseDialog.7d7ff299.js";import{g as D}from"./department.cc67df28.js";import{g as H}from"./circuit.f40043c8.js";import{g as K}from"./extension.7c859f41.js";import{r as y,i as R,f as J,Z as u,o as b,K as k,L as t,a as X,T as l,Q as Y,c as L,a2 as P,F,R as N}from"./@vue.9f1b68af.js";import{b as S,c as $}from"./element-plus.55dd86f2.js";import"./vue-router.949634a5.js";import"./vuex.49683c05.js";import"./moment.a5c37c1e.js";import"./axios.8b958ab2.js";import"./js-cookie.31874410.js";import"./@element-plus.a205db37.js";import"./nprogress.2f56b1fe.js";import"./lodash-es.3d1d9723.js";import"./@vueuse.ef512f30.js";import"./@popperjs.da6c49cb.js";import"./@ctrl.2e36ce53.js";import"./dayjs.644349ef.js";import"./async-validator.5d25c98b.js";import"./memoize-one.4ee5c96d.js";import"./escape-html.e5dfadb9.js";import"./normalize-wheel-es.1c4ac15a.js";const x=[{label:"\u5E8F\u53F7",type:"index",width:"100px"},{label:"\u59D3\u540D",prop:"nickName"},{label:"\u8D26\u53F7",prop:"userName"},{label:"\u90E8\u95E8",prop:"deptName"},{label:"\u5DE5\u53F7",prop:"staffCode"},{label:"\u5206\u673A\u53F7",prop:"extension"},{label:"\u89D2\u8272",prop:"roleName"},{label:"\u7EBF\u8DEF",prop:"gatewayName"},{label:"\u64CD\u4F5C",prop:"operation",slot:"operation"}];function ee(e){return w({url:"qt/user/list",method:"get",params:e})}function oe(e){return w({url:"qt/user/create",method:"post",data:e})}function le(e){return w({url:"qt/user/update",method:"post",data:e})}function ae(e){return w({url:"qt/user/resetPassword",method:"post",data:e})}const te=()=>{const e=y([]),o=()=>{D().then(n=>{e.value=n.root})},s=y([{roleId:10001,roleName:"\u7BA1\u7406\u5458"},{roleId:10002,roleName:"\u5BA2\u670D"}]),a=y([]),h=()=>{H({pageSize:1e4,pageNumber:1}).then(m=>{a.value=m.root})},g=y([]),i=()=>{K({pageSize:1e3,pageNumber:1}).then(m=>{g.value=m.root})};return R(()=>{o(),h(),i()}),{getDepartList:o,departList:e,roleList:s,getGatewayList:h,gateWayList:a,extensionList:g,getExtensionList:i}},re={props:{value:{type:Boolean,default:!1},type:{type:String,default:""},defaultForm:{type:Object,default:()=>({})}},emits:["cancel","confirm"],setup(e,{emit:o}){const s=y(null),a={defaultForm:v({nickName:"",deptId:[],userName:"",password:"",staffCode:"",extensionId:"",roleId:"",gatewayId:""},e.defaultForm),defaultRules:{nickName:[{required:!0,message:"\u8BF7\u8F93\u5165\u59D3\u540D",trigger:"blur"}],deptId:[{required:!0,message:"\u8BF7\u9009\u62E9\u90E8\u95E8",trigger:"change"}],userName:[{required:!0,message:"\u8BF7\u8F93\u5165\u8D26\u53F7",trigger:"blur"}],password:[{required:!0,message:"\u8BF7\u8F93\u5165\u5BC6\u7801",trigger:"blur"}],staffCode:[{required:!0,message:"\u8BF7\u8F93\u5165\u5DE5\u53F7",trigger:"blur"}],extensionId:[{required:!0,message:"\u8BF7\u9009\u62E9\u5206\u673A\u53F7",trigger:"blur"}],roleId:[{required:!0,message:"\u8BF7\u9009\u62E9\u89D2\u8272",trigger:"change"}],gatewayId:[{required:!0,message:"\u8BF7\u9009\u62E9\u7EBF\u8DEF",trigger:"change"}]},confirm:d=>{if(m.value)return!0;m.value=!0;const p=d.userId?"\u7F16\u8F91\u6210\u529F":"\u65B0\u589E\u6210\u529F",_=d.userId?le:oe,c=M(d);c.deptId=c.deptId&&c.deptId.length?c.deptId[c.deptId.length-1]:c.deptId,_(c).then(()=>{S.success(p),n.value=!1,m.value=!1,o("confirm")}).catch(()=>{m.value=!1})},cancel:()=>{n.value=!1,o("cancel")}},h=te();J(()=>e.defaultForm,d=>{g.setForm(v({nickName:"",deptId:[],userName:"",password:"",staffCode:"",extensionId:"",roleId:"",gateWay:"",remark:""},d))});const g=j(s,a),{getTitle:i,visible:n}=Q(e,{create:"\u65B0\u589E",edit:"\u7F16\u8F91"}),m=y(!1),f={checkStrictly:!0,label:"deptName",value:"id",children:"childrenDeptList"};return q(v(v({visible:n,title:i,formRef:s,btnLoading:m},g),h),{propC:f})}},ne={class:"dialog-footer"},se=N("\u53D6\u6D88"),de=N(" \u786E\u5B9A ");function ue(e,o,s,a,h,g){const i=u("el-input"),n=u("el-form-item"),m=u("el-cascader"),f=u("el-option"),d=u("el-select"),p=u("el-form"),_=u("el-button"),c=u("el-dialog");return b(),k(c,{modelValue:a.visible,"onUpdate:modelValue":o[8]||(o[8]=r=>a.visible=r),title:a.title,"before-close":e.handleCancel},{footer:t(()=>[X("span",ne,[l(_,{onClick:e.handleCancel},{default:t(()=>[se]),_:1},8,["onClick"]),l(_,{type:"primary",loading:a.btnLoading,onClick:e.handleConfirm},{default:t(()=>[de]),_:1},8,["loading","onClick"])])]),default:t(()=>[l(p,{ref:"formRef",model:e.form,rules:e.rules,"label-width":"82px"},{default:t(()=>[l(n,{label:"\u59D3\u540D:",prop:"nickName"},{default:t(()=>[l(i,{modelValue:e.form.nickName,"onUpdate:modelValue":o[0]||(o[0]=r=>e.form.nickName=r),placeholder:"\u8BF7\u8F93\u5165\u540D\u79F0"},null,8,["modelValue"])]),_:1}),l(n,{label:"\u90E8\u95E8:",prop:"deptId"},{default:t(()=>[l(m,{modelValue:e.form.deptId,"onUpdate:modelValue":o[1]||(o[1]=r=>e.form.deptId=r),options:e.departList,props:a.propC,style:{width:"100%"},"show-all-levels":!1,clearable:""},null,8,["modelValue","options","props"])]),_:1}),l(n,{label:"\u8D26\u53F7:",prop:"userName"},{default:t(()=>[l(i,{class:"hidden"}),l(i,{modelValue:e.form.userName,"onUpdate:modelValue":o[2]||(o[2]=r=>e.form.userName=r),placeholder:"\u8BF7\u8F93\u5165\u8D26\u53F7",autocomplete:"off",checkStrictly:"",disabled:s.type==="edit"},null,8,["modelValue","disabled"])]),_:1}),s.type!=="edit"?(b(),k(n,{key:0,label:"\u5BC6\u7801:",prop:"password"},{default:t(()=>[l(i,{modelValue:e.form.password,"onUpdate:modelValue":o[3]||(o[3]=r=>e.form.password=r),"show-password":"",placeholder:"\u8BF7\u8F93\u5165\u5BC6\u7801",autocomplete:"new-password"},null,8,["modelValue"])]),_:1})):Y("",!0),l(n,{label:"\u5DE5\u53F7:",prop:"staffCode"},{default:t(()=>[l(i,{modelValue:e.form.staffCode,"onUpdate:modelValue":o[4]||(o[4]=r=>e.form.staffCode=r),placeholder:"\u8BF7\u8F93\u5165\u5DE5\u53F7"},null,8,["modelValue"])]),_:1}),l(n,{label:"\u5206\u673A\u53F7\u7801:",prop:"extensionId"},{default:t(()=>[l(d,{modelValue:e.form.extensionId,"onUpdate:modelValue":o[5]||(o[5]=r=>e.form.extensionId=r),placeholder:"\u8BF7\u9009\u62E9\u5206\u673A\u53F7\u7801",style:{width:"100%"}},{default:t(()=>[(b(!0),L(F,null,P(e.extensionList,(r,C)=>(b(),k(f,{key:C,label:r.extension,value:r.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(n,{label:"\u89D2\u8272:",prop:"roleId"},{default:t(()=>[l(d,{modelValue:e.form.roleId,"onUpdate:modelValue":o[6]||(o[6]=r=>e.form.roleId=r),placeholder:"\u8BF7\u9009\u62E9\u89D2\u8272",style:{width:"100%"}},{default:t(()=>[(b(!0),L(F,null,P(e.roleList,(r,C)=>(b(),k(f,{key:C,label:r.roleName,value:r.roleId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(n,{label:"\u7EBF\u8DEF:",prop:"gatewayId"},{default:t(()=>[l(d,{modelValue:e.form.gatewayId,"onUpdate:modelValue":o[7]||(o[7]=r=>e.form.gatewayId=r),placeholder:"\u8BF7\u9009\u62E9\u7EBF\u8DEF",style:{width:"100%"}},{default:t(()=>[(b(!0),L(F,null,P(e.gateWayList,(r,C)=>(b(),k(f,{key:C,label:r.name,value:r.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title","before-close"])}var me=B(re,[["render",ue]]);const ie={components:{CreateDialog:me},setup(){const e=y(null),o=y({deptId:[],nickName:"",userName:""}),s={checkStrictly:!0,label:"deptName",value:"id",children:"childrenDeptList"},{toQuery:a,clearForm:h}=Z(o,e),g=G(a),i=y([]),n=()=>{D().then(d=>{i.value=d.root})},m=()=>{const{deptId:d}=o.value,p=d.length;o.value.deptId=d&&p?d[p-1]:"",a()},f=d=>{$.prompt("","\u91CD\u7F6E\u5BC6\u7801",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",inputPattern:/^(?![0-9]+$)(?![a-zA-Z]+$)[0-9A-Za-z]{6,}$/,inputErrorMessage:"\u8BF7\u8F93\u51656\u4F4D\u4EE5\u4E0A\u6570\u5B57\u6216\u82F1\u6587\u7684\u5BC6\u7801",inputPlaceholder:"\u8BF7\u8F93\u5165\u65B0\u5BC6\u7801"}).then(({value:p})=>{ae({userId:d,password:p}).then(()=>{S({type:"success",message:"\u91CD\u7F6E\u6210\u529F",duration:1e3}),a()})}).catch(()=>{S({type:"info",message:"\u91CD\u7F6E\u53D6\u6D88"})})};return R(()=>{n()}),q(v({basicTableRef:e,queryParams:o,getAccountList:ee,columns:x,toQuery:a,clearForm:h},g),{departOptions:i,propC:s,handleSearch:m,handleResetClick:f})}},pe=N(" + \u65B0\u5EFA"),ce=N(" \u7F16\u8F91 "),fe=N(" \u91CD\u7F6E\u5BC6\u7801 ");function ge(e,o,s,a,h,g){const i=u("el-cascader"),n=u("el-form-item"),m=u("el-col"),f=u("el-input"),d=u("SearchWrap"),p=u("el-button"),_=u("BasicTable"),c=u("ListContainer"),r=u("CreateDialog"),C=u("PageWrapper");return b(),k(C,null,{default:t(()=>[l(d,{onReset:a.clearForm,onSearch:a.handleSearch,model:a.queryParams},{default:t(({colSpan:I})=>[l(m,{span:I},{default:t(()=>[l(n,{label:"\u90E8\u95E8:"},{default:t(()=>[l(i,{modelValue:a.queryParams.deptId,"onUpdate:modelValue":o[0]||(o[0]=V=>a.queryParams.deptId=V),options:a.departOptions,"show-all-levels":!1,placeholder:"\u8BF7\u9009\u62E9\u90E8\u95E8",props:a.propC,clearable:""},null,8,["modelValue","options","props"])]),_:1})]),_:2},1032,["span"]),l(m,{span:I},{default:t(()=>[l(n,{label:"\u59D3\u540D"},{default:t(()=>[l(f,{modelValue:a.queryParams.nickName,"onUpdate:modelValue":o[1]||(o[1]=V=>a.queryParams.nickName=V),placeholder:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7\u7801"},null,8,["modelValue"])]),_:1})]),_:2},1032,["span"]),l(m,{span:I},{default:t(()=>[l(n,{label:"\u8D26\u53F7"},{default:t(()=>[l(f,{modelValue:a.queryParams.userName,"onUpdate:modelValue":o[2]||(o[2]=V=>a.queryParams.userName=V),placeholder:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7\u7801"},null,8,["modelValue"])]),_:1})]),_:2},1032,["span"])]),_:1},8,["onReset","onSearch","model"]),l(c,null,{default:t(()=>[l(_,{columns:a.columns,queryApi:a.getAccountList,queryParams:a.queryParams,ref:"basicTableRef"},{tableHeader:t(()=>[l(p,{type:"primary",onClick:o[3]||(o[3]=I=>e.handleOperationClick("create"))},{default:t(()=>[pe]),_:1})]),operation:t(({data:I})=>[l(p,{type:"text",onClick:V=>e.handleOperationClick("edit",I)},{default:t(()=>[ce]),_:2},1032,["onClick"]),l(p,{type:"text",onClick:V=>a.handleResetClick(I.userId)},{default:t(()=>[fe]),_:2},1032,["onClick"])]),_:1},8,["columns","queryApi","queryParams"])]),_:1}),l(r,{value:e.showDialog,type:e.typeDialog,defaultForm:e.defaultForm,onCancel:e.handleCancel,onConfirm:e.handleConfirm},null,8,["value","type","defaultForm","onCancel","onConfirm"])]),_:1})}var ze=B(ie,[["render",ge]]);export{ze as default};

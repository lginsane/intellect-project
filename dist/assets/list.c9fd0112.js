var A=Object.defineProperty,W=Object.defineProperties;var Q=Object.getOwnPropertyDescriptors;var S=Object.getOwnPropertySymbols;var j=Object.prototype.hasOwnProperty,I=Object.prototype.propertyIsEnumerable;var B=(e,t,l)=>t in e?A(e,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[t]=l,w=(e,t)=>{for(var l in t||(t={}))j.call(t,l)&&B(e,l,t[l]);if(S)for(var l of S(t))I.call(t,l)&&B(e,l,t[l]);return e},F=(e,t)=>W(e,Q(t));import{d as R}from"./dayjs.644349ef.js";import{s as D,_ as M}from"./index.e88c8aa4.js";import{u as K}from"./UseSearch.32a49bf2.js";import{u as Z,a as G,b as J}from"./UseDialog.7d7ff299.js";import{r as f,_ as X,f as $,Z as s,o as N,K as z,a3 as ee,L as r,a as x,T as a,M as Y,O as E,R as C}from"./@vue.9f1b68af.js";import{U as oe}from"./index.2a290d9c.js";import{b as L,c as te}from"./element-plus.55dd86f2.js";import{Q as ae}from"./@element-plus.a205db37.js";import"./axios.8b958ab2.js";import"./vue-router.949634a5.js";import"./vuex.49683c05.js";import"./moment.a5c37c1e.js";import"./js-cookie.31874410.js";import"./nprogress.2f56b1fe.js";import"./lodash-es.3d1d9723.js";import"./@vueuse.ef512f30.js";import"./@popperjs.da6c49cb.js";import"./@ctrl.2e36ce53.js";import"./async-validator.5d25c98b.js";import"./memoize-one.4ee5c96d.js";import"./escape-html.e5dfadb9.js";import"./normalize-wheel-es.1c4ac15a.js";const ne=[{label:"\u5E8F\u53F7",type:"index",width:"100px"},{label:"\u5BA2\u6237\u6C60\u540D\u79F0",prop:"name"},{label:"\u53F7\u7801\u6570",prop:"numberCount"},{label:"\u521B\u5EFA\u65F6\u95F4",prop:"status",render:e=>R(e.createTime).format("YYYY-MM-DD HH:mm:ss")},{label:"\u66F4\u65B0\u65F6\u95F4",prop:"",render:e=>R(e.updateTime).format("YYYY-MM-DD HH:mm:ss")},{label:"\u5907\u6CE8",prop:"remark"},{label:"\u64CD\u4F5C",prop:"operation",slot:"operation"}];function le(e){return D({url:"qt/customer/pool/list",method:"get",params:e})}function re(e){const t={headers:{"Content-Type":"multipart/form-data"}};return new Promise((l,o)=>D.post("http://106.14.240.168:8080//qt/customer/pool/add",e,t).then(m=>{l(m)}).catch(m=>{o(m)}))}function se(e){const t={headers:{"Content-Type":"multipart/form-data"}};return new Promise((l,o)=>D.post("http://106.14.240.168:8080//qt/customer/pool/update",e,t).then(m=>{l(m)}).catch(m=>{o(m)}))}function ie(e){return D({url:"qt/customer/pool/delete",method:"delete",params:e})}function me(e){return D({url:"call/customer/pool/staff/load",method:"get",params:e})}function ce(e){return D({url:"qt/customer/pool/detail",method:"get",params:e})}const de={props:{value:{type:Boolean,default:!1},type:{type:String,default:""},defaultForm:{type:Object,default:()=>({})}},components:{UploadExcel:oe},emits:["cancel","confirm"],setup(e,{emit:t}){const l=f(null),o=f(!1),m=f([]),b=f([]),d={defaultForm:w({name:"",file:"",remark:""},e.defaultForm),defaultRules:{name:[{required:!0,message:"\u8BF7\u8F93\u5165\u5BA2\u6237\u540D\u79F0",trigger:"change"}],file:[{required:!0,message:"\u8BF7\u4E0A\u4F20\u6587\u4EF6",trigger:"change"}]},confirm:i=>{if(o.value)return;o.value=!0;const{name:h,remark:U,id:k,file:T}=i,H=k?"\u7F16\u8F91\u6210\u529F":"\u65B0\u589E\u6210\u529F",O=k?se:re,V=new FormData;V.append("name",h),T&&T!==1&&V.append("file",T),V.append("remark",U),k&&V.append("id",k),O(V).then(()=>{L({type:"success",message:H,duration:1e3}),b.value=[],u.value=!1,o.value=!1,t("confirm")}).catch(()=>{o.value=!1})},cancel:()=>{b.value=[],u.value=!1,t("cancel")}},p=Z(l,d),{getTitle:y,visible:u,isLook:n}=G(e,{look:"\u5BFC\u5165\u5BA2\u6237\u5217\u8868",create:"\u65B0\u589E",edit:"\u7F16\u8F91"}),_=f(0),v=f(0),g=X({pageNumber:1,pageSize:10}),q=i=>{g.pageNumber=i,c()},c=()=>{const i=F(w({},g),{id:_.value});ce(i).then(h=>{const{root:U,total:k}=h;m.value=U,v.value=k})};$(()=>e.defaultForm,i=>{p.setForm(w({name:"",remark:"",file:i.id?1:""},i)),n.value&&i.id&&(_.value=i.id,c())});const P=i=>{p.form.value.file=i};return F(w({visible:u,title:y,isLook:n,formRef:l,tableData:m,btnLoading:o},p),{handleCurrentPage:q,query:g,pageTotal:v,updateFile:P,fileList:b})}},ue={class:"dialog-footer"},pe=C("\u53D6\u6D88"),fe=C(" \u786E\u5B9A ");function _e(e,t,l,o,m,b){const d=s("el-table-column"),p=s("el-table"),y=s("el-pagination"),u=s("el-input"),n=s("el-form-item"),_=s("UploadExcel"),v=s("el-form"),g=s("el-button"),q=s("el-dialog");return N(),z(q,{modelValue:o.visible,"onUpdate:modelValue":t[3]||(t[3]=c=>o.visible=c),title:o.title,"before-close":e.handleCancel},ee({default:r(()=>[Y(x("div",null,[a(p,{data:o.tableData,style:{width:"100%"},border:""},{default:r(()=>[a(d,{label:"\u5E8F\u53F7",align:"center",type:"index",width:"100px"}),a(d,{label:"\u59D3\u540D",prop:"customerName",align:"center"}),a(d,{label:"\u7535\u8BDD",prop:"customerPhone",align:"center"})]),_:1},8,["data"]),a(y,{onCurrentChange:o.handleCurrentPage,currentPage:o.query.pageNumber,"page-size":o.query.pageSize,layout:"prev, pager, next",total:o.pageTotal},null,8,["onCurrentChange","currentPage","page-size","total"])],512),[[E,o.isLook]]),Y(a(v,{ref:"formRef",model:e.form,rules:e.rules,"label-width":"95px"},{default:r(()=>[a(n,{label:"\u5BA2\u6237\u6C60\u540D\u79F0:",prop:"name"},{default:r(()=>[a(u,{modelValue:e.form.name,"onUpdate:modelValue":t[0]||(t[0]=c=>e.form.name=c),placeholder:"\u8BF7\u8F93\u5165\u5BA2\u6237\u6C60\u540D\u79F0"},null,8,["modelValue"])]),_:1}),a(n,{label:"\u4E0A\u4F20\u6587\u4EF6:",prop:"file"},{default:r(()=>[a(u,{modelValue:e.form.file,"onUpdate:modelValue":t[1]||(t[1]=c=>e.form.file=c),class:"hidden"},null,8,["modelValue"]),a(_,{onUpdateFile:o.updateFile,fileArray:o.fileList},null,8,["onUpdateFile","fileArray"])]),_:1}),a(n,{label:"\u5907\u6CE8:"},{default:r(()=>[a(u,{type:"textarea",modelValue:e.form.remark,"onUpdate:modelValue":t[2]||(t[2]=c=>e.form.remark=c),placeholder:"\u8BF7\u8F93\u5165\u5907\u6CE8"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"]),[[E,!o.isLook]])]),_:2},[o.isLook?void 0:{name:"footer",fn:r(()=>[x("span",ue,[a(g,{onClick:e.handleCancel},{default:r(()=>[pe]),_:1},8,["onClick"]),a(g,{type:"primary",loading:o.btnLoading,onClick:e.handleConfirm},{default:r(()=>[fe]),_:1},8,["loading","onClick"])])])}]),1032,["modelValue","title","before-close"])}var ge=M(de,[["render",_e]]);const he={components:{CreateDialog:ge,Download:ae},setup(){const e=f(null),t=f({name:""}),{toQuery:l,clearForm:o}=K(t,e),m=J(l),b=()=>{const n=document.createElement("a");n.download="\u5BA2\u6237\u6C60.xlsx",n.href="/src/views/manage/client/components/\u5BA2\u6237\u6C60.xlsx",document.body.appendChild(n),n.click(),document.body.removeChild(n)},d=f(null),p=n=>{if(n&&d.value){const _={id:d.value,filePath:n};me(_).then(()=>{L({type:"success",message:"\u5BFC\u5165\u6587\u4EF6\u6210\u529F\uFF01",duration:1e3}),l()})}},y=n=>{d.value=n},u=n=>{te.confirm("\u662F\u5426\u786E\u5B9A\u5220\u9664\uFF1F","\u63D0\u793A",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(()=>{ie({id:n}).then(()=>{L({type:"success",message:"\u5220\u9664\u6210\u529F",duration:1e3}),l()})}).catch(()=>{L({type:"info",message:"\u53D6\u6D88\u5220\u9664"})})};return F(w({basicTableRef:e,queryParams:t,getCustomerList:le,columns:ne,toQuery:l,clearForm:o},m),{handleDownload:b,handleDelete:u,updateFile:p,handleUpload:y})}},be={class:"flex-box flex-between"},ye=C(" + \u65B0\u5EFA"),Ce=C(" \u5BFC\u51FA\u6A21\u7248 "),ve=C("\u8BE6\u60C5"),ke=C(" \u7F16\u8F91 "),we=C(" \u5220\u9664 ");function De(e,t,l,o,m,b){const d=s("el-input"),p=s("el-form-item"),y=s("el-col"),u=s("SearchWrap"),n=s("el-button"),_=s("download"),v=s("el-icon"),g=s("BasicTable"),q=s("ListContainer"),c=s("CreateDialog"),P=s("PageWrapper");return N(),z(P,null,{default:r(()=>[a(u,{"label-width":"100px",onReset:o.clearForm,onSearch:o.toQuery,model:o.queryParams},{default:r(({colSpan:i})=>[a(y,{span:i},{default:r(()=>[a(p,{label:"\u5BA2\u6237\u6C60\u540D\u79F0:"},{default:r(()=>[a(d,{modelValue:o.queryParams.name,"onUpdate:modelValue":t[0]||(t[0]=h=>o.queryParams.name=h),placeholder:"\u8BF7\u8F93\u5165\u5BA2\u6237\u6C60\u540D\u79F0"},null,8,["modelValue"])]),_:1})]),_:2},1032,["span"])]),_:1},8,["onReset","onSearch","model"]),a(q,null,{default:r(()=>[a(g,{columns:o.columns,queryApi:o.getCustomerList,queryParams:o.queryParams,ref:"basicTableRef"},{tableHeader:r(()=>[x("div",be,[a(n,{type:"primary",onClick:t[1]||(t[1]=i=>e.handleOperationClick("create"))},{default:r(()=>[ye]),_:1}),a(n,{type:"primary",onClick:o.handleDownload},{default:r(()=>[a(v,{size:"14px"},{default:r(()=>[a(_)]),_:1}),Ce]),_:1},8,["onClick"])])]),operation:r(({data:i})=>[a(n,{type:"text",onClick:h=>e.handleOperationClick("look",i)},{default:r(()=>[ve]),_:2},1032,["onClick"]),a(n,{type:"text",onClick:h=>e.handleOperationClick("edit",i)},{default:r(()=>[ke]),_:2},1032,["onClick"]),a(n,{type:"text",style:{color:"#f56c6c"},onClick:h=>o.handleDelete(i.id)},{default:r(()=>[we]),_:2},1032,["onClick"])]),_:1},8,["columns","queryApi","queryParams"])]),_:1}),a(c,{value:e.showDialog,type:e.typeDialog,defaultForm:e.defaultForm,onCancel:e.handleCancel,onConfirm:e.handleConfirm},null,8,["value","type","defaultForm","onCancel","onConfirm"])]),_:1})}var Ke=M(he,[["render",De]]);export{Ke as default};
